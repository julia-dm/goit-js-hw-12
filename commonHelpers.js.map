{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixibay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '44796717-c9697056d5a7f56baa85540ad';\nconst BASE_URL = 'https://pixabay.com/api/';\naxios.defaults.baseURL = BASE_URL;\n\nfunction getPicture({ q = '', page = 1, per_page = 15 } = {}) {\n  return axios\n    .get('', {\n      params: {\n        key: API_KEY,\n        q,\n        page,\n        per_page,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n      },\n    })\n    .then(({ data }) => data);\n}\n\nexport { getPicture };\n","function showSearchResults(hits) {\n  return hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"152\" />\n            <ul class=\"description\">\n              <li class=\"description-items\">\n                <span class=\"item\">Likes </span>${likes}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"item\">Views </span>${views}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"item\">Comments </span>${comments}\n              </li>\n              <li class=\"description-items\">\n                <span class=\"item\">Downloads </span>${downloads}\n              </li>\n            </ul>\n          </a>\n        </li>`\n    )\n    .join('');\n}\n\nexport { showSearchResults };\n","import { getPicture } from './js/pixibay-api.js';\nimport { showSearchResults } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst defaults = {\n  searchForm: document.querySelector('.search-form'),\n  input: document.querySelector('.search-input'),\n  gallery: document.querySelector('.card-container'),\n  loader: document.querySelector('.loader'),\n  loadMore: document.querySelector('.load-more'),\n  btnLoad: document.querySelector('.btn'),\n};\n\nconst params = {\n  q: '',\n  page: 1,\n  per_page: 15,\n  maxPage: 0,\n};\n\nconst lightbox = new simpleLightbox('.card-container a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst buttonService = {\n  hide(button) {\n    button.classList.add('is-hidden');\n  },\n  show(button) {\n    button.classList.remove('is-hidden');\n  },\n  disable(button) {\n    button.disabled = true;\n  },\n  enable(button) {\n    button.disabled = false;\n  },\n};\n\ndefaults.searchForm.addEventListener('submit', handleSearch);\ndefaults.btnLoad.addEventListener('click', handleLoadMore);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  defaults.gallery.innerHTML = '';\n  buttonService.hide(defaults.btnLoad);\n  defaults.loader.classList.remove('visually-hidden');\n\n  params.page = 1;\n  const form = event.currentTarget;\n  params.q = form.elements.query.value.trim();\n\n  if (!params.q) {\n    iziToast.error({\n      iconUrl: './img/error.svg',\n      message: 'Search field cannot be empty!',\n      position: 'topRight',\n      backgroundColor: '#ef4040',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n    defaults.loader.classList.add('visually-hidden');\n    return;\n  }\n\n  try {\n    const { totalHits, hits } = await getPicture(params);\n    params.maxPage = Math.ceil(totalHits / params.per_page);\n\n    defaults.gallery.innerHTML = showSearchResults(hits);\n\n    if (hits.length > 0 && params.page < params.maxPage) {\n      buttonService.show(defaults.btnLoad);\n    } else {\n      buttonService.hide(defaults.btnLoad);\n      iziToast.info({\n        iconUrl: './img/info.svg',\n        message: \"We're sorry, but there are no more results.\",\n        position: 'topRight',\n        backgroundColor: '#09f',\n        messageColor: 'white',\n        titleColor: 'white',\n      });\n    }\n\n    lightbox.refresh();\n  } catch (err) {\n    console.error(`Error during request: ${err}`);\n    iziToast.error({\n      iconUrl: './img/error.svg',\n      message: `Error during request: ${err}`,\n      position: 'topRight',\n      backgroundColor: '#ef4040',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n  } finally {\n    form.reset();\n    defaults.loader.classList.add('visually-hidden');\n  }\n}\n\nasync function handleLoadMore() {\n  buttonService.hide(defaults.btnLoad);\n  defaults.loadMore.classList.remove('visually-hidden');\n  params.page += 1;\n\n  try {\n    const { hits } = await getPicture(params);\n    defaults.gallery.insertAdjacentHTML('beforeend', showSearchResults(hits));\n\n    const cardHeight = getCardHeight();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (params.page >= params.maxPage) {\n      buttonService.hide(defaults.btnLoad);\n      iziToast.info({\n        iconUrl: './img/info.svg',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        backgroundColor: '#09f',\n        messageColor: 'white',\n        titleColor: 'white',\n      });\n    } else {\n      buttonService.show(defaults.btnLoad);\n    }\n\n    lightbox.refresh();\n  } catch (err) {\n    console.error(`Error during request: ${err}`);\n    iziToast.error({\n      iconUrl: './img/error.svg',\n      message: `Error during request: ${err}`,\n      position: 'topRight',\n      backgroundColor: '#ef4040',\n      messageColor: 'white',\n      titleColor: 'white',\n    });\n  } finally {\n    buttonService.enable(defaults.btnLoad);\n    defaults.loadMore.classList.add('visually-hidden');\n  }\n}\n\nfunction getCardHeight() {\n  const card = document.querySelector('.card-container .card');\n  return card ? card.getBoundingClientRect().height : 0;\n}\n"],"names":["API_KEY","BASE_URL","axios","getPicture","q","page","per_page","data","showSearchResults","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","defaults","params","lightbox","simpleLightbox","buttonService","button","handleSearch","handleLoadMore","event","form","iziToast","totalHits","err","cardHeight","getCardHeight","card"],"mappings":"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"}